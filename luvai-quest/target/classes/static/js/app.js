//static card resources for spring application
var all = {
	name : "All",
	type : "misc",
	link : "/resources/images/all.png"
};
var back = {
	name : "back",
	type : "misc",
	link : "/resources/images/card-back.png"
};
var horse = {
	name : "Horse",
	type : "weapon",
	link : "/resources/images/W Horse.jpg"
};
var sword = {
	name : "Sword",
	type : "weapon",
	link : "/resources/images/W Sword.jpg"
};
var dagger = {
	name : "Dagger",
	type : "weapon",
	link : "/resources/images/W Dagger.jpg"
};
var lance = {
	name : "Lance",
	type : "weapon",
	link : "/resources/images/W Lance.jpg"
};
var battleAx = {
	name : "Battle-ax",
	type : "weapon",
	link : "/resources/images/W Battle-ax.jpg"
};
var excalibur = {
	name : "Excalibur",
	type : "weapon",
	link : "/resources/images/W Excalibur.jpg"
};
var robberKnight = {
	name : "Robber Knight",
	type : "foe",
	link : "/resources/images/F Robber Knight.jpg"
};
var saxons = {
	name : "Saxons",
	type : "foe",
	link : "/resources/images/F Saxons.jpg"
};
var boar = {
	name : "Boar",
	type : "foe",
	link : "/resources/images/F Boar.jpg"
};
var thieves = {
	name : "Thieves",
	type : "foe",
	link : "/resources/images/F Thieves.jpg"
};
var greenKnight = {
	name : "Green Knight",
	type : "foe",
	link : "/resources/images/F Green Knight.jpg"
};
var blackKnight = {
	name : "Black Knight",
	type : "foe",
	link : "/resources/images/F Black Knight.jpg"
};
var evilKnight = {
	name : "Evil Knight",
	type : "foe",
	link : "/resources/images/F Evil Knight.jpg"
};
var saxonKnight = {
	name : "Saxon Knight",
	type : "foe",
	link : "/resources/images/F Saxon Knight.jpg"
};
var dragon = {
	name : "Dragon",
	type : "foe",
	link : "/resources/images/F Dragon.jpg"
};
var giant = {
	name : "Giant",
	type : "foe",
	link : "/resources/images/F Giant.jpg"
};
var mordred = {
	name : "Mordred",
	type : "foe",
	link : "/resources/images/F Mordred.jpg"
};
var sirG = {
	name : "Sir Gawain",
	type : "ally",
	link : "/resources/images/A Sir Gawain.jpg"
};
var sirPe = {
	name : "King Pellinore",
	type : "ally",
	link : "/resources/images/A King Pellinore.jpg"
};
var sirP = {
	name : "Sir Percival",
	type : "ally",
	link : "/resources/images/A Sir Percival.jpg"
};
var sirT = {
	name : "Sir Tristan",
	type : "ally",
	link : "/resources/images/A Sir Tristan.jpg"
};
var sirL = {
	name : "Sir Lance",
	type : "ally",
	link : "/resources/images/A Sir Lancelot.jpg"
};
var sirGa = {
	name : "Sir Galahad",
	type : "ally",
	link : "/resources/images/A Sir Galahad.jpg"
};
var queenG = {
	name : "Queen Guinevere",
	type : "ally",
	link : "/resources/images/A Queen Guinevere.jpg"
};
var queenI = {
	name : "Queen Iseult",
	type : "ally",
	link : "/resources/images/A Queen Iseult.jpg"
};
var arthur = {
	name : "King Arthur",
	type : "ally",
	link : "/resources/images/A King Arthur.jpg"
};
var merlin = {
	name : "Merlin",
	type : "ally",
	link : "/resources/images/A Merlin.jpg"
};
var amour = {
	name : "Amour",
	type : "amour",
	link : "/resources/images/Amour.jpg"
};
var chivalrousDeed = {
	name : "Chivalrous Deed",
	type : "event",
	link : "/resources/images/E Chivalrous Deed.jpg"
};
var courtCamelot = {
	name : "Court Called to Camelot",
	type : "event",
	link : "/resources/images/E Court Called Camelot.jpg"
};
var callToArms = {
	name : "King's Call to Arms",
	type : "event",
	link : "/resources/images/E King's Call to Arms.jpg"
};
var recognition = {
	name : "King's Recognition",
	type : "event",
	link : "/resources/images/E King's Recognition.jpg"
};
var plague = {
	name : "Plague",
	type : "event",
	link : "/resources/images/E Plague.jpg"
};
var pox = {
	name : "Pox",
	type : "event",
	link : "/resources/images/E Pox.jpg"
};
var prosperity = {
	name : "Prosperity Throughout the Realm",
	type : "event",
	link : "/resources/images/E Prosperity Throughout the Realm.jpg"
};
var queensFavor = {
	name : "Queen's Favor",
	type : "event",
	link : "/resources/images/E Queen's Favor.jpg"
};
var testMorgan = {
	name : "Test of Morgan Le Fey",
	type : "test",
	link : "/resources/images/T Test of Morgan Le Fey.jpg"
};
var testTemp = {
	name : "Test of Temptation",
	type : "test",
	link : "/resources/images/T Test of the Questing Beast.jpg"
};
var testBeast = {
	name : "Test of the Questing Beast",
	type : "test",
	link : "/resources/images/T Test of the Questing Beast.jpg"
};
var testValor = {
	name : "Test of Valor",
	type : "test",
	link : "/resources/images/T Test of Valor.jpg"
};
var arthurQuest = {
	name : "Vanquish King Arthur's Enemies",
	type : "quest",
	link : "/resources/images/Q Arthur.jpg"
};
var beastQuest = {
	name : "Search for the Questing Beast",
	type : "quest",
	link : "/resources/images/Q Beast.jpg"
};
var boarQuest = {
	name : "Boar Hunt",
	type : "quest",
	link : "/resources/images/Q Boar.jpg"
};
var dragonQuest = {
	name : "Slay the Dragon",
	type : "quest",
	link : "/resources/images/Q Dragon.jpg"
};
var forestQuest = {
	name : "Journey through the Enchanted Forest",
	type : "quest",
	link : "/resources/images/Q Forest.jpg"
};
var grailQuest = {
	name : "Search for the Holy Grail",
	type : "quest",
	link : "/resources/images/Q Grail.jpg"
};
var gkQuest = {
	name : "Test of the Green Knight",
	type : "quest",
	link : "/resources/images/Q Green.jpg"
};
var honorQuest = {
	name : "Defend the Queen's Honor",
	type : "quest",
	link : "/resources/images/Q Honor.jpg"
};
var maidenQuest = {
	name : "Rescue the Fair Maiden",
	type : "quest",
	link : "/resources/images/Q Maiden.jpg"
};
var saxonQuest = {
	name : "Repel the Saxon Raiders",
	type : "quest",
	link : "/resources/images/Q Saxon.jpg"
};
var squire = {
	name : "Squire",
	type : "rank",
	link : "/resources/images/R Squire.jpg"
};
var knight = {
	name : "Knight",
	type : "rank",
	link : "/resources/images/R Knight.jpg"
};
var cKnight = {
	name : "Champion Knight",
	type : "rank",
	link : "/resources/images/R Champion Knight.jpg"
};
var camelot = {
	name : "At Camelot",
	type : "tournament",
	link : "/resources/images/T1.jpg"
};
var orkney = {
	name : "At Ornkey",
	type : "tournament",
	link : "/resources/images/T2.jpg"
};
var tintagel = {
	name : "At Tintagel",
	type : "tournament",
	link : "/resources/images/T3.jpg"
};
var york = {
	name : "At York",
	type : "tournament",
	link : "/resources/images/T4.jpg"
};
var cardTypeList = [ back, horse, sword, lance, dagger, battleAx, excalibur,
		robberKnight, saxons, boar, thieves, greenKnight, blackKnight,
		evilKnight, saxonKnight, dragon, giant, mordred, sirG, sirPe, sirP,
		sirT, sirL, sirGa, queenG, queenI, arthur, merlin, amour,
		chivalrousDeed, courtCamelot, callToArms, recognition, plague, pox,
		prosperity, queensFavor, testMorgan, testTemp, testBeast, testValor,
		arthurQuest, beastQuest, dragonQuest, forestQuest, grailQuest, gkQuest,
		honorQuest, maidenQuest, saxonQuest, squire, knight, cKnight, camelot,
		orkney, tintagel, york ];

var PlayerName = "";
var serverMsg = document.getElementById('serverMsg');
var socketConn = new WebSocket('ws://localhost:8080/socketHandler');
var storyCardFaceUp;
var stageCounter = 1;
var stageTracker = 0;
var foes = [];
var weapons = [];
var tempWeaponArr = [];
var tempWeaponArr2 = [];
var questInfo;
var participantInfo;
var FoeInfo = "";
var currentPlayerInfo = "";
var currentPlayerPts = 0;
var sponsor = "";
var numCards =0;
// when connection is initiated
socketConn.onopen = function(event) {

};

// messages from server received here
socketConn.onmessage = function(event) {

	var serverMsg = document.getElementById('serverMsg');
	
	//sponsor pickup
	if(event.data.startsWith("SponsorPickUp")) {
		console.log("sponsor pick up time");
	}
	// get card pick up on starting stage
	if (event.data.startsWith("pickupBeforeStage")) {
		var pickUpLink = event.data.replace("pickupBeforeStage", "");
		$("#extra1").attr("src", "http://localhost:8080" + pickUpLink);
		var card1 = document.getElementById("card1").src;
		var card2 = document.getElementById("card2").src;
		var card3 = document.getElementById("card3").src;
		var card4 = document.getElementById("card4").src;
		var card5 = document.getElementById("card5").src;
		var card6 = document.getElementById("card6").src;
		var card7 = document.getElementById("card7").src;
		var card8 = document.getElementById("card8").src;
		var card9 = document.getElementById("card9").src;
		var card10 = document.getElementById("card10").src;
		var card11 = document.getElementById("card11").src;
		var card12 = document.getElementById("card12").src;
		var extra1 = document.getElementById("extra1").src;
		var extra2 = document.getElementById("extra2").src;
		var extra3 = document.getElementById("extra3").src;
		var extra4 = document.getElementById("extra4").src;
		var extra5 = document.getElementById("extra5").src;
		var extra6 = document.getElementById("extra6").src;
		var extra7 = document.getElementById("extra7").src;
		var extra8 = document.getElementById("extra8").src;
		var imageArray = [ card1, card2, card3, card4, card5, card6, card7, card8, card9, card10, card11, card12, extra1, extra2, extra3, extra4, extra5, extra6, extra7, extra8 ];
		var cardTracker = 0;
		for(var i=0; i<imageArray.length; i++) {
			var tempCardLink = imageArray[i].replace("http://localhost:8080","");
			tempCardLink = tempCardLink.split('%20').join(' ');
			console.log(tempCardLink);
			if(tempCardLink!="/resources/images/all.png") cardTracker++;
		}
		console.log(cardTracker);
		numCards = cardTracker;
		if(cardTracker > 12) {
			document.getElementById("doneEquipment").disabled = true;
			serverMsg.value += " You must choose a card to continue (or right-click to discard) ";
		}
	}
	
	// no winners in quest
	if (event.data.startsWith("Quest over, no winners")) {
		serverMsg.value = event.data;
	}
	//get round info for participant
	if (event.data == "RoundWon") {
		console.log("You won");
	}
	if(event.data == "RoundLost") {
		console.log("You lost");
	}
	
	//round info for viewers
	if (event.data=="NextRound") {
		console.log("battle won, next round");
	}
	if (event.data == "BattleOver") {
		console.log("battle lost, next turn");
	}
	
	// get current player pts
	if (event.data.startsWith("currentPlayerPoints")) {
		var pts = event.data.replace("currentPlayerPoints", "");
		currentPlayerInfo = pts;
		console.log(PlayerName);
		console.log(sponsor);
		if(PlayerName == sponsor) { stageCounter = 1;}
		displayBattle(stageCounter);
	}
	// get foe info
	if (event.data.startsWith("FoeInfo")) {
		var temp = event.data.replace("FoeInfo", "");
		FoeInfo = temp;
	}
	// quest in progress
	if (event.data.startsWith("questInProgress")) {
		var name = event.data.replace("questInProgress", "");
		serverMsg.value = "Player " + name
				+ " is entering quest, wait for battle...";
	}
	// no participants for sponsor
	if (event.data == "No participants") {
		serverMsg.value = "No one won/participated, receiving shields/cards for setup, going to next turn";
		// socketConn.send("flipStoryDeck");
	}
	// set name for testing purposes
	if (event.data.startsWith("SetName")) {
		var name = event.data.replace("SetName", "");
		PlayerName = name;
	}
	// participation
	if (event.data == "AskToParticipate") {
		document.getElementById("acceptQuest").style.display = "inline";
		serverMsg.value = "Please accept/decline quest by clicking below"
	}
	// get current participant info
	if (event.data.startsWith("currentParticipantInfo")) {
		participantInfo = event.data.replace("currentParticipantInfo", "");
	}

	// get point info for current battle
	if (event.data.startsWith("pointInfo")) {

	}
	// get current quest info
	if (event.data.startsWith("currentQuestInfo")) {
		questInfo = event.data.replace("currentQuestInfo", "");
		questInfo = JSON.parse(questInfo);
		// console.log(questInfo);
	}
	// flip story deck
	if (event.data.startsWith("flipStoryDeck")) {
		serverMsg.value += "\nFlipping card from Story Deck";
		var card = event.data.replace('flipStoryDeck', '');
		card = JSON.parse(card);
		storyCardFaceUp = card;
		stageTracker = storyCardFaceUp.stages;
		$("#storyCard").attr("src", "http://localhost:8080" + card.stringFile);

	}
	// set hand
	if (event.data.startsWith("setHand")) {
		serverMsg.value = "Setting player hand, flipping story deck";
		var handString = event.data.replace('setHand', '');
		var handStringArray = handString.split(":");
		$("#card1").attr("src", handStringArray[0]);
		$("#card2").attr("src", handStringArray[1]);
		$("#card3").attr("src", handStringArray[2]);
		$("#card4").attr("src", handStringArray[3]);
		$("#card5").attr("src", handStringArray[4]);
		$("#card6").attr("src", handStringArray[5]);
		$("#card7").attr("src", handStringArray[6]);
		$("#card8").attr("src", handStringArray[7]);
		$("#card9").attr("src", handStringArray[8]);
		$("#card10").attr("src", handStringArray[9]);
		$("#card11").attr("src", handStringArray[10]);
		$("#card12").attr("src", handStringArray[11]);
	}

	// alert player of quest setup
	if (event.data == ("QuestBeingSetup")) {
		serverMsg.value = "Quest is being setup, please wait";
	}

	// ask to sponsor quest
	if (event.data === "sponsorQuest") {
		document.getElementById('sponsorQuest').style.display = 'block';
		serverMsg.value = "Click to answer below"
	}
	// no participants in quest
	if (event.data == ("EmptyQuest")) {
		serverMsg.value = "No one participated/won in the quest - wait for next turn";
	}
	// if game is full - deny message
	if (event.data.startsWith("Too many players")) {
		serverMsg.value = event.data;
	}
	// welcome message
	if (event.data.startsWith("Welcome")) {
		serverMsg.value = event.data;
	}

	// player enrollment
	if (event.data.startsWith("You are all set up")) {
		serverMsg.value = event.data;
	}

	// game started
	if (event.data
			.startsWith("All players have joined, starting game, wait for your turn...")) {
		document.getElementById('print').disabled = false;
		serverMsg.value = event.data;
	}
}

// display current battle
function displayBattle(stage) {
	
	document.getElementById('battleScreen').style.display = "block";
	var playerInfo = currentPlayerInfo.split(";");
	currentPlayerPts = playerInfo[0];
	var playerCardLink = getLinkFromName(playerInfo[1]);
	var weaponArr = playerInfo[2].split("#");

	var weaponLinks = [];
	for (var j = 0; j < weaponArr.length; j++) {
		weaponLinks.push(getLinkFromName(weaponArr[j]));
	}

	weaponLinks.pop(); //popping empty character 

	var foeLinks = [];
	var foeWeaponNames = questInfo.weapons;
	var foeWeaponLinks = [];

	for (var i = 0; i < foeWeaponNames.length; i++) {
		var currentStageWeps = [];
		for (var j = 0; j < foeWeaponNames[i].length; j++) {
			currentStageWeps.push(getLinkFromName(foeWeaponNames[i][j]));

		}
		foeWeaponLinks.push(currentStageWeps);
	}

	var foesInfo = FoeInfo.split(";");
	for (var i = 0; i < foesInfo.length; i++) {
		foesInfo[i] = foesInfo[i].split("#");
		foeLinks.push(getLinkFromName(foesInfo[i][0]));
	}

	foeLinks.pop(); // might cause issues

	var pequip = [];
	var fequip = [];
	for (var i = 0; i < 6; i++) {
		pequip[i] = all.link;
		fequip[i] = all.link;
	}

	for (var i = 0; i < weaponLinks.length; i++) {
		pequip.pop();
		pequip.unshift(weaponLinks[i]);
	}

	for (var i = 0; i < foeWeaponLinks[stage - 1].length; i++) {
		fequip.pop();
		fequip.unshift(foeWeaponLinks[stage - 1][i]);
	}
	
	$("#playerPic").attr("src", playerCardLink);
	$("#playerWeaponSpot1").attr("src", pequip[0]);
	$("#playerWeaponSpot2").attr("src", pequip[1]);
	$("#playerWeaponSpot3").attr("src", pequip[2]);
	$("#playerWeaponSpot4").attr("src", pequip[3]);
	$("#playerWeaponSpot5").attr("src", pequip[4]);
	$("#playerWeaponSpot6").attr("src", pequip[5]);
	$("#enemyPic").attr("src", foeLinks[stage - 1]);
	$("#enemyWeaponSpot1").attr("src", fequip[0]);
	$("#enemyWeaponSpot2").attr("src", fequip[1]);
	$("#enemyWeaponSpot3").attr("src", fequip[2]);
	$("#enemyWeaponSpot4").attr("src", fequip[3]);
	$("#enemyWeaponSpot5").attr("src", fequip[4]);
	$("#enemyWeaponSpot6").attr("src", fequip[5]);
	var playerWin;
	var tempPPoints = (Number)(currentPlayerPts);
	var tempFPoints = (Number)(foesInfo[stage-1][1]);
	console.log(tempPPoints); console.log(tempFPoints);
	if(tempPPoints >= tempFPoints) {
		playerWin = true; 
		console.log("here");
		console.log(tempPPoints);
		console.log(tempFPoints);
		} else { 
			playerWin = false; }
	console.log(playerWin);

	if(playerWin) {
		document.getElementById("p_win").style.display = "block";
		document.getElementById("f_lose").style.display = "block";
		var serverMsg = document.getElementById('serverMsg');
		if(serverMsg.value.startsWith("Player")) {
			serverMsg.value = "This battle was won...please wait for next round to complete";
		} else {
			setTimeout(function(){ 
				var serverMsg = document.getElementById('serverMsg');
				serverMsg.value = "Round won...equip for next round";
				document.getElementById('battleScreen').style.display = "none";
				}, 4000);
			
		}

	} else {
		document.getElementById("p_lose").style.display = "block";
		document.getElementById("f_win").style.display = "block";
		setTimeout(function(){ 
			var serverMsg = document.getElementById('serverMsg');
			if(serverMsg.value=="Going into battle") { 
				var data = JSON.stringify({ 'nextQuestTurn' : 0});
				socketConn.send(data);}
			serverMsg.value = "Round lost, going to next turn... ";
			document.getElementById('battleScreen').style.display = "none";
			}, 4000);
		
	}
	
	var data = JSON.stringify({
		'name' : PlayerName,
		'roundOver' : playerWin
	});
	var serverMsg = document.getElementById('serverMsg');
	if(serverMsg.value=="Going into battle") {
		socketConn.send(data);
	}
}
// setup quest if sponsor
function setupQuestRound() {

	if (stageCounter <= stageTracker) {
		var serverMsg = document.getElementById('serverMsg');
		serverMsg.value += "\nChoose foe card for stage: " + stageCounter;
		$('body')
				.on(
						'click',
						'#card1, #card2, #card3, #card4, #card5, #card6, #card7, #card8, #card9, #card10, #card11, #card12',
						function() {
							var cardSrc = this.src.replace(
									'http://localhost:8080', '');
							cardSrc = cardSrc.split('%20').join(' ');
							var cardName = checkForCardType(cardSrc, "foe");
							if (cardName != "card not found") {
								foes.push(cardName);
								var changeImageId = "#" + this.id;
								$(changeImageId).attr("src",
										"/resources/images/all.png");
								serverMsg.value = "Choose weapons for foe";
								document.getElementById('doneQuest').style.display = "inline";
								choosingWeapons = true;
								$('body')
										.off(
												'click',
												'#card1, #card2, #card3, #card4, #card5, #card6, #card7, #card8, #card9, #card10, #card11, #card12');
								$('body')
										.on(
												'click',
												'#card1, #card2, #card3, #card4, #card5, #card6, #card7, #card8, #card9, #card10, #card11, #card12',
												function() {
													var cardSrc = this.src
															.replace(
																	'http://localhost:8080',
																	'');
													cardSrc = cardSrc.split(
															'%20').join(' ');
													var cardName = checkForCardType(
															cardSrc, "weapon");
													if (cardName != "card not found") {
														tempWeaponArr
																.push(cardName)
														var changeImageId = "#"
																+ this.id;
														$(changeImageId)
																.attr("src",
																		"/resources/images/all.png");
													}
												})
							}
						})
	}
}

//discard function
function discard(){
	$('body')
	.on(
			'contextmenu',
			'#card1, #card2, #card3, #card4, #card5, #card6, #card7, #card8, #card9, #card10, #card11, #card12, #extra1, #extra2, #extra3, #extra4, #extra5, #extra7, #extra6, #extra7, #extra8',
			function() {
				
				if(this.src!="http://localhost:8080/resources/images/all.png") {
					if(numCards>12) {
						$(this).attr("src", "/resources/images/all.png");
						numCards--;
						if(numCards>=12) { document.getElementById("doneEquipment").disabled = false; }
					}
				}
			})
	return false;
}
// accept to participate in quest
function acceptQuestParticipate() {
	document.getElementById('acceptQuest').style.display = "none";
	var data = JSON.stringify({
		'name' : PlayerName,
		'participate_quest' : true
	});
	socketConn.send(data);
	var serverMsg = document.getElementById('serverMsg');
	serverMsg.value = ("Click on the equipment you wish to use for battle\nReceiving 1 card");
	document.getElementById('doneEquipment').style.display = "inline";
	$('body')
			.on(
					'click',
					'#card1, #card2, #card3, #card4, #card5, #card6, #card7, #card8, #card9, #card10, #card11, #card12, #extra1, #extra2, #extra3, #extra4, #extra5, #extra7, #extra6, #extra7, #extra8',
					function() {

						if(numCards>=12) { 
							document.getElementById("doneEquipment").disabled = false;
							}
						
						var cardSrc = this.src.replace('http://localhost:8080',
								'');
						cardSrc = cardSrc.split('%20').join(' ');
						var allyCardName = checkForCardType(cardSrc, "ally");
						var weaponCardName = checkForCardType(cardSrc, "weapon");
						var amourCardName = checkForCardType(cardSrc, "amour");

						if (allyCardName != "card not found") {
							tempWeaponArr2.push(allyCardName)
							var changeImageId = "#" + this.id;
							numCards--;
							$(changeImageId).attr("src",
									"/resources/images/all.png");
						}
						if (weaponCardName != "card not found") {
							tempWeaponArr2.push(weaponCardName)
							var changeImageId = "#" + this.id;
							numCards--;
							$(changeImageId).attr("src",
									"/resources/images/all.png");
						}
						if (amourCardName != "card not found") {
							tempWeaponArr2.push(amourCardName)
							var changeImageId = "#" + this.id;
							numCards--;
							$(changeImageId).attr("src",
									"/resources/images/all.png");
						}
						
					})
}

// send weapon info - done choosing
function doneEquipment() {
	document.getElementById('doneEquipment').style.display = "none";
	var serverMsg = document.getElementById('serverMsg');
	serverMsg.value = "Going into battle";
	$('body')
			.off(
					'click',
					'#card1, #card2, #card3, #card4, #card5, #card6, #card7, #card8, #card9, #card10, #card11, #card12, #extra1, #extra2, #extra3, #extra4, #extra5, #extra7, #extra6, #extra7, #extra8');
	var data = JSON.stringify({
		'name' : PlayerName,
		'stages' : stageCounter,
		'equipment_info' : tempWeaponArr2
	});
	socketConn.send(data);
}

// deny participation in quest
function denyQuestParticipate() {
	document.getElementById('acceptQuest').style.display = "none";
	var data = JSON.stringify({
		'name' : PlayerName,
		'participate_quest' : false
	});
	socketConn.send(data);
	var serverMsg = document.getElementById('serverMsg');
	serverMsg.value = ("Waiting for other players to finish quest...");
}

// finished setting up quest for sponsor
function doneWeaponsQuestSponsor() {

	var serverMsg = document.getElementById('serverMsg');
	document.getElementById('doneQuest').style.display = "none";

	if (stageCounter == stageTracker) {
		weapons.push(tempWeaponArr);
		tempWeaponArr = [];
		serverMsg.value = "Done setup";
		$('body')
				.off(
						'click',
						'#card1, #card2, #card3, #card4, #card5, #card6, #card7, #card8, #card9, #card10, #card11, #card12');
		serverMsg.value += '\nWaiting on results...';
		var questData = JSON.stringify({
			'foes' : foes,
			'weapons' : weapons
		})
		socketConn.send(questData);
	} else {
		serverMsg.value = "Choose next foe";
		$('body')
				.off(
						'click',
						'#card1, #card2, #card3, #card4, #card5, #card6, #card7, #card8, #card9, #card10, #card11, #card12');
		weapons.push(tempWeaponArr);
		tempWeaponArr = [];
		stageCounter++;
		setupQuestRound();
	}

}

// get link from name
function getLinkFromName(name) {
	for (var i = 0; i < cardTypeList.length; i++) {
		if (cardTypeList[i].name == name)
			return cardTypeList[i].link;
	}
	return "card not found";
}

// check card type
function checkForCardType(cardSrc, type) {
	for (var i = 0; i < cardTypeList.length; i++) {
		if (cardSrc == cardTypeList[i].link) {
			if (cardTypeList[i].type == type) {
				return cardTypeList[i].name;
			}
		}
	}
	return "card not found";
}

// accept to sponsor quest
function acceptSponsorQuest() {
	document.getElementById('sponsorQuest').style.display = 'none';
	var serverMsg = document.getElementById('serverMsg');
	serverMsg.value = "You are sponsor, setting up quest...";
	sponsor = PlayerName;
	var data = JSON.stringify({
		'name' : PlayerName,
		'sponsor_quest' : true
	});
	socketConn.send(data);
	setupQuestRound();
}
// deny to sponsor quest
function denySponsorQuest() {
	document.getElementById('sponsorQuest').style.display = 'none';
	var data = JSON.stringify({
		'name' : PlayerName,
		'sponsor_quest' : false
	});
	socketConn.send(data);
	var serverMsg = document.getElementById('serverMsg');
	serverMsg.value = "Waiting for other players...";
}
// flip story card
function flipStoryDeck() {
	// socketConn.send("flipStoryDeck");
}

// static resource test, changes title back and forth from red and black
function changeColor() {
	var title = document.getElementById('title');
	if (title.className == 'color1') {
		title.className = 'color2';
	} else {
		title.className = 'color1';
	}
}

// send name to server -> adds client to player list
function send() {
	var clientMsg = document.getElementById('enterName');
	if (clientMsg.value) {
		PlayerName = clientMsg.value;
		var data = JSON.stringify({
			'name' : $("#enterName").val()
		})
		socketConn.send(data);
		document.getElementById('title').innerHTML = "Welcome to the Quest of The Round Table - "
				+ clientMsg.value + "'s View";
		changeColor();
		document.getElementById('enterName').style.display = "none";
		document.getElementById('send').style.display = "none";
	}
}

// print all clients connected
function print() {
	// socketConn.send("Print");
}

// proof of connection - prints deck proof also
function proof() {
	// socketConn.send("Proof");
}
